<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>MCP Tools Demo - AI Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tool-card {
            @apply bg-white rounded-lg shadow-md p-6 mb-4 border-l-4 border-blue-500;
        }

        .param-badge {
            @apply inline-block bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded mr-2 mb-2;
        }

        .loading {
            @apply inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 ml-2;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-lg shadow-lg mb-8">
        <h1 class="text-3xl font-bold mb-2">üîß MCP Tools Demo</h1>
        <p class="text-blue-100">–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è MCP (Model Context Protocol) —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
            –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤</p>
    </div>

    <!-- Status Card -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <h2 class="text-xl font-semibold mb-4">–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h2>
        <div class="flex items-center">
            <span class="inline-block w-3 h-3 bg-gray-400 rounded-full mr-2" id="status-indicator"></span>
            <span class="text-gray-600" id="status-text">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</span>
            <div class="loading" id="loading-spinner"></div>
        </div>
        <div class="mt-4 text-sm text-gray-500" id="connection-info"></div>
    </div>

    <!-- Tools Container -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
            <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors"
                    id="refresh-btn">
                üîÑ –û–±–Ω–æ–≤–∏—Ç—å
            </button>
        </div>

        <div class="text-gray-600 mb-4" id="tools-count">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤...</div>

        <div class="space-y-4" id="tools-container">
            <!-- Tools will be loaded here -->
        </div>
    </div>

    <!-- Code Example -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <h2 class="text-xl font-semibold mb-4">–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞</h2>
        <p class="text-gray-600 mb-4">Kotlin –∫–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:</p>
        <pre class="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto"><code>val mcpClient = McpClient()
val tools = mcpClient.connectToMcpServer()

tools.forEach { tool ->
    println("–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ${tool.name}")
    println("–û–ø–∏—Å–∞–Ω–∏–µ: ${tool.description}")
    println("–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: ${tool.inputSchema.keys}")
}</code></pre>
    </div>
</div>

<script>
    let tools = [];

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
    function updateStatus(connected, message = '') {
        const indicator = document.getElementById('status-indicator');
        const text = document.getElementById('status-text');
        const spinner = document.getElementById('loading-spinner');
        const info = document.getElementById('connection-info');

        spinner.style.display = 'none';

        if (connected) {
            indicator.className = 'inline-block w-3 h-3 bg-green-500 rounded-full mr-2';
            text.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ MCP —Å–µ—Ä–≤–µ—Ä—É';
            if (message) {
                info.textContent = message;
            }
        } else {
            indicator.className = 'inline-block w-3 h-3 bg-red-500 rounded-full mr-2';
            text.textContent = '–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è';
            if (message) {
                info.textContent = message;
            }
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
    function displayTools(toolsList) {
        const container = document.getElementById('tools-container');
        const count = document.getElementById('tools-count');

        count.textContent = `–ù–∞–π–¥–µ–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: ${toolsList.length}`;

        if (toolsList.length === 0) {
            container.innerHTML = '<p class="text-gray-500 text-center py-8">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
            return;
        }

        container.innerHTML = toolsList.map(tool => `
                <div class="tool-card">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-semibold text-gray-800">${tool.name}</h3>
                        <span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">TOOL</span>
                    </div>

                    <p class="text-gray-600 mb-4">${tool.description}</p>

                    <div class="mb-3">
                        <h4 class="text-sm font-semibold text-gray-700 mb-2">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</h4>
                        <div class="flex flex-wrap">
                            ${Object.keys(tool.inputSchema || {}).map(param => `
                                <span class="param-badge">${param}</span>
                            `).join('')}
                            ${Object.keys(tool.inputSchema || {}).length === 0 ?
            '<span class="text-gray-400 text-sm">–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</span>' : ''}
                        </div>
                    </div>

                    ${Object.keys(tool.inputSchema || {}).length > 0 ? `
                        <details class="text-sm">
                            <summary class="cursor-pointer text-gray-600 hover:text-gray-800">–°—Ö–µ–º–∞ JSON</summary>
                            <pre class="mt-2 bg-gray-50 p-3 rounded text-xs overflow-x-auto">${JSON.stringify(tool.inputSchema, null, 2)}</pre>
                        </details>
                    ` : ''}
                </div>
            `).join('');
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
    async function loadTools() {
        try {
            document.getElementById('loading-spinner').style.display = 'inline-block';

            const response = await fetch('/mcp/tools');
            const data = await response.json();

            if (response.ok && data.status === 'connected') {
                tools = data.tools || [];
                updateStatus(true, `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${tools.length} –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤`);
                displayTools(tools);
            } else {
                updateStatus(false, data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
                displayTools([]);
            }
        } catch (error) {
            updateStatus(false, `–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`);
            displayTools([]);
        }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    document.getElementById('refresh-btn').addEventListener('click', loadTools);

    // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('DOMContentLoaded', loadTools);

    // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    setInterval(loadTools, 30000);
</script>
</body>
</html>